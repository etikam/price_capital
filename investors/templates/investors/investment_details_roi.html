{% extends 'investors/investment_base.html' %}
{% load static %}
{% block main_content %}
<div class="tab-pane fade show active" id="investment-details">
  <h2 class="mb-4 text-center fs-1">
    <i class="fas fa-info-circle"></i> Détails de l'Investissement
  </h2>

  <!-- Bouton Retour -->
  <div class="text-start mb-4">
    <a href="{% url 'investor:investment-dashboard' %}" class="btn btn-secondary">
      <i class="fas fa-arrow-left"></i> Retour au tableau de bord
    </a>
  </div>

  <!-- Statistiques clés -->
  <div class="row mb-4">
    <div class="col-md-3 mb-3">
      <div class="card border-primary shadow-sm h-100">
        <div class="card-body text-center">
          <i class="fas fa-coins fa-3x text-primary mb-3"></i>
          <h5 class="card-title">Montant Investi</h5>
          <h2 class="card-text">{{ investissement.amount|floatformat:2 }} {{ investissement.currency }}</h2>
        </div>
      </div>
    </div>

    <div class="col-md-3 mb-3">
      <div class="card border-info shadow-sm h-100">
        <div class="card-body text-center">
          <i class="fas fa-percentage fa-3x text-info mb-3"></i>
          <h5 class="card-title">Interet du projet</h5>
          <h2 class="card-text">{{ investissement.project.gains|floatformat:2 }} {{investissement.project.currency}}</h2>
        </div>
      </div>
    </div>

    <div class="col-md-3 mb-3">
      <div class="card border-success shadow-sm h-100">
        <div class="card-body text-center">
          <i class="fas fa-chart-line fa-3x text-success mb-3"></i>
          <h5 class="card-title">Mon Interet</h5>
          <h2 class="card-text">{{ investissement.gains|floatformat:2 }} {{ investissement.currency }}</h2>
        </div>
      </div>
    </div>

    <div class="col-md-3 mb-3">
      <div class="card border-info shadow-sm h-100">
        <div class="card-body text-center">
          <i class="fas fa-percentage fa-3x text-info mb-3"></i>
          <h5 class="card-title">Mon Pourcentage</h5>
          <h2 class="card-text">{{ investissement.percentage_on_goal|floatformat:2 }}%</h2>
        </div>
      </div>
    </div>
  </div>

  <!-- Graphique d'évolution des gains -->
  <div class="card shadow-sm mb-4">
    <div class="card-header bg-success text-white">
      <h5 class="card-title mb-0">
        <i class="fas fa-chart-line"></i> Évolution des Gains
      </h5>
    </div>
    <div class="card-body">
      <canvas id="gainEvolutionChart"></canvas>
    </div>
  </div>
</div>

<!-- Script pour les graphiques -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  // Évolution des Gains
  const gainEvolutionCtx = document.getElementById('gainEvolutionChart').getContext('2d');
  const gainEvolutionChart = new Chart(gainEvolutionCtx, {
    type: 'line',
    data: {
      labels: {{ gain_evolution_labels|safe }}, // Semaines
      datasets: [{
        label: 'Gains Hebdomadaires (GNF)',
        data: {{ gain_evolution_data|safe }}, // Montants des gains
        borderColor: '#28a745',
        backgroundColor: 'rgba(40, 167, 69, 0.2)',
        fill: true,
        tension: 0.3
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: {
          display: true,
          position: 'bottom'
        }
      },
      scales: {
        x: {
          title: {
            display: true,
            text: 'Semaine'
          }
        },
        y: {
          title: {
            display: true,
            text: 'Montant (GNF)'
          },
          beginAtZero: true
        }
      }
    }
  });
</script>
{% endblock %}